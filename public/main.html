<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø´Ø±ÙƒØ© - Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</title>
    <link rel="stylesheet" href="./main.css">
    <!-- ØªØ­Ù…ÙŠÙ„ Ù…Ù„ÙØ§Øª Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ Ø£ÙˆÙ„Ø§Ù‹ -->
    <script src="./config-env.js"></script>
    <script src="./config.js"></script>
    <!-- Ø¥Ø¶Ø§ÙØ© Ø®Ø·ÙˆØ· Ø¬ÙˆØ¬Ù„ -->
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">
    <!-- Ø¥Ø¶Ø§ÙØ© Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3a0ca3;
            --accent: #4cc9f0;
            --success: #4ade80;
            --warning: #f59e0b;
            --danger: #ef4444;
            --dark: #1e293b;
            --light: #f8fafc;
            --gray: #64748b;
            --gradient: linear-gradient(135deg, #4361ee, #3a0ca3);
            --gradient-light: linear-gradient(135deg, #4cc9f0, #4361ee);
            --shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Tajawal', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
            color: var(--dark);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* ØªØµÙ…ÙŠÙ… Ø§Ù„Ù‡ÙŠØ¯Ø± */
        header {
            background: var(--gradient);
            color: white;
            box-shadow: var(--shadow);
            position: relative;
            z-index: 100;
        }

        .banner {
            padding: 15px 20px;
        }

        .banner:first-child {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        #user-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        #user-info span {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            background: rgba(255, 255, 255, 0.15);
            padding: 8px 15px;
            border-radius: 50px;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        #user-info span i {
            font-size: 16px;
        }

        /* ØªØµÙ…ÙŠÙ… Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© */
        .dropdown-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }

        .dropdown {
            position: relative;
            display: inline-block;
        }

        .dropbtn {
            background: rgba(255, 255, 255, 0.15);
            color: white;
            padding: 12px 20px;
            font-size: 14px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
        }

        .dropbtn:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .dropdown-content {
            display: none;
            position: absolute;
            background: white;
            min-width: 220px;
            box-shadow: var(--shadow-lg);
            border-radius: 12px;
            z-index: 1;
            overflow: hidden;
            margin-top: 8px;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .dropdown-content a {
            color: var(--dark);
            padding: 12px 16px;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.2s ease;
            border-bottom: 1px solid #f1f5f9;
        }

        .dropdown-content a:last-child {
            border-bottom: none;
        }

        .dropdown-content a:hover {
            background: #f8fafc;
            padding-right: 20px;
            color: var(--primary);
        }

        .dropdown-content a i {
            width: 20px;
            text-align: center;
            color: var(--gray);
        }

        .dropdown-content a:hover i {
            color: var(--primary);
        }

        .disabled-link {
            opacity: 0.5;
            pointer-events: none;
            background: #f1f5f9 !important;
            color: #94a3b8 !important;
        }

        .disabled-link i {
            color: #94a3b8 !important;
        }

        /* Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
        .main-content {
            padding: 30px 20px;
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„ØªØ±Ø­ÙŠØ¨ */
        .welcome-section {
            margin-bottom: 40px;
            text-align: center;
        }

        .welcome-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .welcome-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 8px;
            background: var(--gradient);
        }

        .welcome-card h1 {
            color: var(--dark);
            margin-bottom: 15px;
            font-size: 28px;
            font-weight: 700;
        }

        .welcome-card p {
            color: var(--gray);
            font-size: 16px;
            max-width: 600px;
            margin: 0 auto 20px;
            line-height: 1.6;
        }

        /* Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø³Ø±ÙŠØ¹Ø© */
        .stats-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: white;
            border-radius: 16px;
            padding: 25px;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s ease;
            border-left: 4px solid var(--primary);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
        }

        .stat-1 .stat-icon { background: var(--primary); }
        .stat-2 .stat-icon { background: var(--success); }
        .stat-3 .stat-icon { background: var(--accent); }
        .stat-4 .stat-icon { background: var(--warning); }

        .stat-info h3 {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 5px;
            color: var(--dark);
        }

        .stat-info p {
            color: var(--gray);
            font-size: 14px;
        }

        /* Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø­Ø¯ÙŠØ«Ø© */
        .cards-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
        }

        .feature-card {
            background: white;
            border-radius: 16px;
            padding: 25px;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .feature-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 4px;
            background: var(--gradient);
        }

        .feature-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-lg);
        }

        .feature-icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-bottom: 20px;
            background: var(--gradient-light);
            color: white;
        }

        .feature-card h3 {
            font-size: 18px;
            margin-bottom: 12px;
            color: var(--dark);
        }

        .feature-card p {
            color: var(--gray);
            font-size: 14px;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .feature-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: var(--primary);
            font-weight: 500;
            text-decoration: none;
            font-size: 14px;
            transition: all 0.2s ease;
        }

        .feature-link:hover {
            gap: 12px;
            color: var(--secondary);
        }

        /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø®Ù„ÙÙŠØ© */
        .background-effects {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }

        .floating-circle {
            position: absolute;
            border-radius: 50%;
            background: rgba(67, 97, 238, 0.05);
            animation: float 15s infinite ease-in-out;
        }

        .circle-1 {
            width: 300px;
            height: 300px;
            top: 10%;
            left: 5%;
            animation-delay: 0s;
        }

        .circle-2 {
            width: 200px;
            height: 200px;
            top: 60%;
            right: 10%;
            animation-delay: 5s;
        }

        .circle-3 {
            width: 150px;
            height: 150px;
            bottom: 20%;
            left: 15%;
            animation-delay: 10s;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(10deg); }
        }

        /* Ø²Ø± ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª */
        .refresh-btn {
            position: fixed;
            bottom: 30px;
            left: 30px;
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 50px;
            cursor: pointer;
            z-index: 100;
            font-size: 14px;
            font-weight: 500;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .refresh-btn:hover {
            background: var(--secondary);
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        /* Ø²Ø± Ø¥ØµÙ„Ø§Ø­ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª */
        .fix-btn {
            position: fixed;
            bottom: 90px;
            left: 30px;
            background: var(--success);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 50px;
            cursor: pointer;
            z-index: 100;
            font-size: 14px;
            font-weight: 500;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .fix-btn:hover {
            background: #16a34a;
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        /* Ø²Ø± Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© */
        .create-btn {
            position: fixed;
            bottom: 150px;
            left: 30px;
            background: var(--accent);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 50px;
            cursor: pointer;
            z-index: 100;
            font-size: 14px;
            font-weight: 500;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .create-btn:hover {
            background: #3aa8d0;
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        /* ØªØµÙ…ÙŠÙ… Ù…ØªØ¬Ø§ÙˆØ¨ */
        @media (max-width: 768px) {
            .dropdown-container {
                flex-direction: column;
                align-items: center;
            }
            
            .dropdown {
                width: 100%;
            }
            
            .dropbtn {
                width: 100%;
                justify-content: center;
            }
            
            .dropdown-content {
                width: 100%;
            }
            
            #user-info {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .stats-section {
                grid-template-columns: 1fr;
            }
            
            .cards-section {
                grid-template-columns: 1fr;
            }
            
            .welcome-card h1 {
                font-size: 24px;
            }

            .refresh-btn, .fix-btn, .create-btn {
                left: 15px;
                bottom: 15px;
                font-size: 12px;
                padding: 10px 15px;
            }

            .fix-btn {
                bottom: 75px;
            }

            .create-btn {
                bottom: 135px;
            }
        }
    </style>
</head>
<body>
    <!-- ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø®Ù„ÙÙŠØ© -->
    <div class="background-effects">
        <div class="floating-circle circle-1"></div>
        <div class="floating-circle circle-2"></div>
        <div class="floating-circle circle-3"></div>
    </div>

    <header>
        <div class="banner">
            <div id="user-info">
                <span><i class="fas fa-user"></i> <span id="username">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: </span></span>
                <span><i class="fas fa-store"></i> <span id="store-name">Ø§Ø³Ù… Ø§Ù„ÙØ±Ø¹: </span></span>
                <span><i class="fas fa-calendar"></i> <span id="current-date">ØªØ§Ø±ÙŠØ® Ø§Ù„ÙŠÙˆÙ…: </span></span>
                <span><i class="fas fa-shield-alt"></i> <span id="user-privileges-status">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</span></span>
            </div>
        </div>

        <div class="banner">
            <div class="dropdown-container">
                <div class="dropdown">
                    <button class="dropbtn"><i class="fas fa-users"></i> Ø§Ø¯Ø®Ø§Ù„ Ø´Ø¦ÙˆÙ† Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</button>
                    <div class="dropdown-content">
                        <a id="dept-link" href="./dept.html"><i class="fas fa-sitemap"></i> Ø§Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ù‚Ø³Ø§Ù…</a>
                        <a id="empl-link" href="./empl.html"><i class="fas fa-user-tie"></i> Ø§Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</a>
                        <a id="payroll-link" href="./payroll.html"><i class="fas fa-money-bill-wave"></i> Ø§Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…Ø±ØªØ¨Ø§Øª</a>
                        <a id="attend-link" href="./attend.html"><i class="fas fa-user-clock"></i> Ø§Ø¯Ø®Ø§Ù„ Ø­Ø¶ÙˆØ± ÙˆØ§Ù†ØµØ±Ø§Ù</a>
                    </div>
                </div>
                <div class="dropdown">
                    <button class="dropbtn"><i class="fas fa-database"></i> Ø§Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø³Ø§Ø³ÙŠÙ‡</button>
                    <div class="dropdown-content">
                        <a id="company-link" href="./company.html"><i class="fas fa-building"></i> Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†Ø´Ø£Ø©</a>
                        <a id="stores-link" href="./stores.html"><i class="fas fa-code-branch"></i> Ø§ÙƒÙˆØ§Ø¯ Ø§Ù„ÙØ±ÙˆØ¹</a>
                        <a id="unit-link" href="./unit.html"><i class="fas fa-ruler-combined"></i> Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„ÙˆØ­Ø¯Ø§Øª</a>
                        <a id="suppliers-link" href="./suppliers.html"><i class="fas fa-truck-loading"></i> Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ†</a>
                        <a id="customer-link" href="./customer.html"><i class="fas fa-users"></i> Ø£ÙƒÙˆØ§Ø¯ Ø¹Ù…Ù„Ø§Ø¡</a>
                        <a id="items-link" href="./items.html"><i class="fas fa-boxes"></i> Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø§ØµÙ†Ø§Ù</a>
                        <a id="master-link" href="./master.html"><i class="fas fa-warehouse"></i> Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ØµÙ†Ø§Ù Ø¨Ø§Ù„ÙØ±ÙˆØ¹</a>
                        <a id="transferItem-link" href="./transferItem.html"><i class="fas fa-exchange-alt"></i> ØªØ­ÙˆÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ÙØ±ÙˆØ¹</a>
                        <a id="acceptTransfer-link" href="./acceptTransfer.html"><i class="fas fa-dolly"></i> Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„ØªØ­ÙˆÙŠÙ„</a>
                        <a id="offers-link" href="./offers.html"><i class="fas fa-tags"></i> Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø§Ø³Ø¹Ø§Ø±</a>
                    </div>
                </div>
                <div class="dropdown">
                    <button class="dropbtn"><i class="fas fa-shopping-cart"></i> Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</button>
                    <div class="dropdown-content">
                        <a id="purchases-link" href="./purchases.html"><i class="fas fa-cart-plus"></i> Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</a>
                        <a id="purchases_ret-link" href="./purchases_ret.html"><i class="fas fa-undo"></i> Ù…Ø±ØªØ¬Ø¹ Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</a>
                    </div>
                </div>
                <div class="dropdown">
                    <button class="dropbtn"><i class="fas fa-cash-register"></i> Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</button>
                    <div class="dropdown-content">
                        <a id="sales-link" href="./sales.html"><i class="fas fa-receipt"></i> Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</a>
                        <a id="salesreturn-link" href="./salesreturn.html"><i class="fas fa-undo-alt"></i> Ù…Ø±ØªØ¬Ø¹ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</a>
                    </div>
                </div>
                <div class="dropdown">
                    <button class="dropbtn"><i class="fas fa-chart-bar"></i> ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙØ±ÙˆØ¹</button>
                    <div class="dropdown-content">
                        <a id="purchases_rep-link" href="./purchases_rep.html"><i class="fas fa-file-invoice"></i> ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</a>
                        <a id="purchase_return_rep-link" href="./purchase_return_rep.html"><i class="fas fa-file-excel"></i> ØªÙ‚Ø±ÙŠØ± Ù…Ø±ØªØ¬Ø¹ Ù…Ø´ØªØ±ÙŠØ§Øª</a>
                        <a id="sales_report-link" href="./sales_report.html"><i class="fas fa-chart-line"></i> ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</a>
                        <a id="salesreturn_rep-link" href="./salesreturn_rep.html"><i class="fas fa-file-export"></i> ØªÙ‚Ø±ÙŠØ± Ù…Ø±ØªØ¬Ø¹ Ù…Ø¨ÙŠØ¹Ø§Øª</a>
                        <a id="masterrep" href="./masterrep.html"><i class="fas fa-chart-area"></i> ØªÙ‚Ø±ÙŠØ± Ø­Ø±ÙƒØ© Ø§Ù„ÙØ±ÙˆØ¹</a>
                        <a id="transferReport-link" href="./transferReport.html"><i class="fas fa-exchange-alt"></i> ØªÙ‚Ø±ÙŠØ± ØªØ­ÙˆÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ÙØ±ÙˆØ¹</a>
                        <a id="accptRep-link" href="./accptRep.html"><i class="fas fa-clipboard-check"></i> ØªÙ‚Ø±ÙŠØ± Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„ØªØ­ÙˆÙŠÙ„</a>
                        <a id="inventoryrep-link" href="./inventoryrep.html"><i class="fas fa-clipboard-list"></i> ØªÙ‚Ø±ÙŠØ± Ø¬Ø±ÙˆØ¯ Ø§Ù„ÙØ±ÙˆØ¹</a>
                        <a id="dailyCashier-link" href="./dailyCashier.html"><i class="fas fa-clipboard-list"></i> ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙƒØ§Ø´ÙŠØ±</a>
                    </div>
                </div>
                <div class="dropdown">
                    <button class="dropbtn"><i class="fas fa-file-invoice-dollar"></i> Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠÙ‡</button>
                    <div class="dropdown-content">
                        <a id="acc_type-link" href="./acc_type.html"><i class="fas fa-file-invoice"></i> Ø§ÙƒÙˆØ§Ø¯ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</a>
                        <a id="account-link" href="./account.html"><i class="fas fa-sitemap"></i> Ø´Ø¬Ø±Ø© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</a>
                        <a id="acc_transaction-link" href="./acc_transaction.html"><i class="fas fa-exchange-alt"></i> Ø­Ø±ÙƒØ© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</a>
                        <a id="account_report-link" href="./account_report.html"><i class="fas fa-chart-pie"></i> Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠØ©</a>
                    </div>
                </div>
                <div class="dropdown">
                    <button class="dropbtn"><i class="fas fa-search"></i> Ø§Ù„Ø¨Ø­Ø«</button>
                    <div class="dropdown-content">
                        <a id="search-link" href="./search.html"><i class="fas fa-search"></i> Ø¨Ø­Ø« Ø¨Ø§Ù„ÙƒÙˆØ¯ Ø§Ùˆ Ø¨Ø§Ù„Ø§Ø³Ù…</a>
                        <a id="offershow-link" href="./offershow.html"><i class="fas fa-percentage"></i> Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ù…ØªØ§Ø­Ù‡</a>
                    </div>
                </div>
                <div class="dropdown">
                    <button class="dropbtn"><i class="fas fa-cogs"></i> Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</button>
                    <div class="dropdown-content">
                        <a id="user-link" href="./user.html"><i class="fas fa-user-plus"></i> Ø§Ø¯Ø®Ø§Ù„ Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ù†Ø¸Ø§Ù…</a>
                        <a id="privileges-link" href="./privileges.html"><i class="fas fa-user-shield"></i> ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</a>
                        <a id="user_active_rep-link" href="./user_active_rep.html"><i class="fas fa-user-check"></i> ØªÙ‚Ø±ÙŠØ± Ø¨ØªØ¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</a>
                    </div>
                </div>
                <div class="dropdown">
                    <button class="dropbtn"><i class="fas fa-info-circle"></i> Ø­ÙˆÙ„</button>
                    <div class="dropdown-content">
                        <a href="./about.html"><i class="fas fa-info"></i> Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</a>
                        <a href="./contact.html"><i class="fas fa-phone"></i> ØªÙˆØ§ØµÙ„</a>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
    <div class="main-content">
        <!-- Ù‚Ø³Ù… Ø§Ù„ØªØ±Ø­ÙŠØ¨ -->
        <section class="welcome-section">
            <div class="welcome-card">
                <h1>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø´Ø±ÙƒØ©</h1>
                <p>Ù†Ø¸Ø§Ù… Ù…ØªÙƒØ§Ù…Ù„ Ù„Ø¥Ø¯Ø§Ø±Ø© ÙƒØ§ÙØ© Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø´Ø±ÙƒØ© Ù…Ù† Ù…Ø¨ÙŠØ¹Ø§Øª ÙˆÙ…Ø´ØªØ±ÙŠØ§Øª ÙˆÙ…Ø®Ø§Ø²Ù† ÙˆØ­Ø³Ø§Ø¨Ø§Øª ÙˆÙ…ÙˆØ§Ø±Ø¯ Ø¨Ø´Ø±ÙŠØ©</p>
                <div class="stats-section">
                    <div class="stat-card stat-1">
                        <div class="stat-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="sales-count">0</h3>
                            <p>Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª </p>
                        </div>
                    </div>
                    <div class="stat-card stat-2">
                        <div class="stat-icon">
                            <i class="fas fa-shopping-cart"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="purchases-count">0</h3>
                            <p>Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª </p>
                        </div>
                    </div>
                    <div class="stat-card stat-3">
                        <div class="stat-icon">
                            <i class="fas fa-boxes"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="inventory-count">0</h3>
                            <p>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ø§Ù„ÙØ±Ø¹</p>
                        </div>
                    </div>
                    <div class="stat-card stat-4">
                        <div class="stat-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="employees-count">0</h3>
                            <p>Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø­Ø¯ÙŠØ«Ø© -->
        <section class="cards-section">
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-chart-pie"></i>
                </div>
                <h3>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</h3>
                <p>Ø¹Ø±Ø¶ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù…ÙØµÙ„Ø© Ø¹Ù† Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø´Ø±ÙƒØ© ÙˆØ§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª ÙˆØ§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª ÙˆØ§Ù„ØªØ­ÙˆÙŠÙ„Ø§Øª Ø¨ÙŠÙ† Ø§Ù„ÙØ±ÙˆØ¹</p>
                <a href="#" class="feature-link"><i class="fas fa-arrow-left"></i></a>
            </div>
            
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-exchange-alt"></i>
                </div>
                <h3>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ÙØ±ÙˆØ¹</h3>
                <p>Ø¥Ø¯Ø§Ø±Ø© Ø¹Ù…Ù„ÙŠØ© ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø¨ÙŠÙ† ÙØ±ÙˆØ¹ Ø§Ù„Ø´Ø±ÙƒØ© Ø§Ù„Ù…Ø®ØªÙ„ÙØ© ÙˆØªØªØ¨Ø¹ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„Ø§Øª</p>
                <a href="./transferItem.html" class="feature-link"><i class="fas fa-arrow-left"></i></a>
            </div>
            
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-file-invoice-dollar"></i>
                </div>
                <h3>Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠØ©</h3>
                <p>ØªÙ‚Ø§Ø±ÙŠØ± Ø´Ø§Ù…Ù„Ø© Ø¹Ù† Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…Ø§Ù„ÙŠ Ù„Ù„Ø´Ø±ÙƒØ© ÙˆØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ø¨ÙƒÙØ§Ø¡Ø© Ø¹Ø§Ù„ÙŠØ©</p>
                <a href="./account_report.html" class="feature-link"><i class="fas fa-arrow-left"></i></a>
            </div>
        </section>
    </div>

    <!-- Ø²Ø± ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª -->
    <button class="refresh-btn" id="refreshPermissionsBtn">
        <i class="fas fa-sync-alt"></i> ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
    </button>

    <!-- Ø²Ø± Ø¥ØµÙ„Ø§Ø­ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª -->
    <button class="fix-btn" id="fixPermissionsBtn">
        <i class="fas fa-wrench"></i> Ø¥ØµÙ„Ø§Ø­ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
    </button>

    <!-- Ø²Ø± Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© -->
    <button class="create-btn" id="createDefaultPrivilegesBtn">
        <i class="fas fa-plus-circle"></i> Ø¥Ù†Ø´Ø§Ø¡ ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
    </button>

    <script>
        // âœ… ØªÙ‡ÙŠØ¦Ø© Supabase ÙÙŠ main.html
        const SUPABASE_URL = 'https://rvjacvrrpguehbapvewe.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ2amFjdnJycGd1ZWhiYXB2ZXdlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMwMjUxNTksImV4cCI6MjA3ODYwMTE1OX0.wSavKzxKOF7-56G-pzDMtbXNrCNAbGs0wvadw-cilBg';

        // ØªÙ‡ÙŠØ¦Ø© Supabase
        window.supabase = window.supabase?.createClient?.(SUPABASE_URL, SUPABASE_KEY) || null;

        if (window.supabase) {
            console.log('âœ… Supabase Ø¬Ø§Ù‡Ø² ÙÙŠ main.html');
        } else {
            console.warn('âš ï¸ Supabase ØºÙŠØ± Ù…ØªØ§Ø­ ÙÙŠ main.html');
        }
        
        // âœ… Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„Ù…Ø­Ù„ÙŠ - Ø§Ø³ØªØ®Ø¯Ø§Ù… Supabase ÙÙ‚Ø·
        const openWindows = [];

        class MainMenuManager {
            constructor() {
                this.userPrivileges = {};
                this.screenPermissions = {};
                this.branchPermissions = {};
                this.userId = null;
                this.currentBranchId = null;
                this.init();
            }

            async init() {
                try {
                    this.userId = await this.checkAuthentication();
                    if (!this.userId) return;
                    
                    await this.loadUserPrivileges();
                    await this.loadBranchPermissions();
                    this.applyPermissionsToMenu();
                    this.setupEventListeners();
                    this.updateUserInfo();
                    this.initializeStats(); // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
                    
                    // âœ… ØªØ´Ø®ÙŠØµ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
                    setTimeout(() => {
                        this.diagnosePrivileges();
                    }, 2000);
                    
                } catch (error) {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©:', error);
                    document.getElementById('user-privileges-status').textContent = 'âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªÙ‡ÙŠØ¦Ø©';
                }
            }

            // ğŸ§© Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
            async checkAuthentication() {
                const userId = localStorage.getItem('user_id') || sessionStorage.getItem('user_id');
                if (!userId) {
                    alert('âŒ ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹');
                    window.location.href = './index.html';
                    return null;
                }
                return userId;
            }

            // ğŸ§© ØªØ­Ù…ÙŠÙ„ ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            async loadUserPrivileges() {
                try {
                    if (!this.userId) return;

                    console.log('ğŸ”„ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…:', this.userId);

                    // Ù…Ø­Ø§ÙˆÙ„Ø© Ø¬Ù„Ø¨ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø¨Ø§Ø´Ø±Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
                    let userPrivileges = await this.fetchUserPrivileges();
                    
                    if (!userPrivileges || userPrivileges.length === 0) {
                        console.warn('âš ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙ„Ø§Ø­ÙŠØ§Øª Ù…Ø­Ø¯Ø¯Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ØŒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©');
                        this.setDefaultPermissions();
                        document.getElementById('user-privileges-status').textContent = 'âš ï¸ ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ©';
                        return;
                    }

                    this.organizePrivileges(userPrivileges);
                    document.getElementById('user-privileges-status').textContent = 'âœ… Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ù…Ø­Ù…Ù„Ø©';
                    
                } catch (error) {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª:', error);
                    document.getElementById('user-privileges-status').textContent = 'âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª';
                    this.setDefaultPermissions();
                }
            }

            // ğŸ§© ØªØ­Ù…ÙŠÙ„ ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„ÙØ±ÙˆØ¹
            async loadBranchPermissions() {
                try {
                    this.currentBranchId = localStorage.getItem('branch_id') || sessionStorage.getItem('branch_id');
                    
                    // âœ… Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù‡Ù†Ø§Ùƒ branch_idØŒ Ù†Ø³ØªØ®Ø¯Ù… store_id Ù…Ù† localStorage
                    if (!this.currentBranchId) {
                        this.currentBranchId = localStorage.getItem('store_id') || sessionStorage.getItem('store_id');
                        console.log('ğŸ”„ Ø§Ø³ØªØ®Ø¯Ø§Ù… store_id ÙƒØ¨Ø¯ÙŠÙ„:', this.currentBranchId);
                    }

                    // âœ… Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù‡Ù†Ø§Ùƒ branch_id Ø¨Ø¹Ø¯ØŒ Ù†Ø³ØªØ®Ø¯Ù… Ù‚ÙŠÙ…Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
                    if (!this.currentBranchId) {
                        console.warn('âš ï¸ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø¹Ø±Ù ÙØ±Ø¹ØŒ Ø§Ø³ØªØ®Ø¯Ø§Ù… ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ©');
                        this.branchPermissions = {
                            can_transfer: true,  // âœ… ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹
                            can_receive: true    // âœ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹
                        };
                        return;
                    }

                    console.log('ğŸ”„ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„ÙØ±Ø¹:', this.currentBranchId);

                    // âŒ Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„Ù…Ø­Ù„ÙŠ - Ø§Ø³ØªØ®Ø¯Ø§Ù… ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„Ù„ÙØ±ÙˆØ¹
                    console.log('ğŸŒ Ø§Ø³ØªØ®Ø¯Ø§Ù… ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„Ù„ÙØ±ÙˆØ¹');
                    this.branchPermissions = {
                        can_transfer: true,
                        can_receive: true,
                        branch_id: this.currentBranchId
                    };

                    // âœ… Ø­ÙØ¸ ÙÙŠ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ Ù„Ù„Ù…Ø²Ø§Ù…Ù†Ø©
                    localStorage.setItem('branchPermissions', JSON.stringify(this.branchPermissions));
                    
                } catch (error) {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„ÙØ±Ø¹:', error);
                    this.branchPermissions = {
                        can_transfer: true,  // âœ… ØªÙØ¹ÙŠÙ„ Ø§ÙØªØ±Ø§Ø¶ÙŠ
                        can_receive: true    // âœ… ØªÙØ¹ÙŠÙ„ Ø§ÙØªØ±Ø§Ø¶ÙŠ
                    };
                }
            }

            // ğŸ§© Ø¬Ù„Ø¨ ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø¹ Ø¯Ø¹Ù… Supabase ÙˆØ¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
            async fetchUserPrivileges() {
                try {
                    console.log('ğŸ”„ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…:', this.userId);

                    // âœ… Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰: Ø§Ø³ØªØ®Ø¯Ø§Ù… Supabase Ù…Ø¨Ø§Ø´Ø±Ø©
                    if (window.supabase) {
                        console.log('ğŸŒ Ù…Ø­Ø§ÙˆÙ„Ø© Ø¬Ù„Ø¨ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ù…Ù† Supabase...');
                        
                        const { data, error } = await window.supabase
                            .from('privileges')
                            .select('*')
                            .eq('user_id', this.userId);
                        
                        if (!error && data && data.length > 0) {
                            console.log(`âœ… ØªÙ… Ø¬Ù„Ø¨ ${data.length} ØµÙ„Ø§Ø­ÙŠØ© Ù…Ù† Supabase`);
                            return data;
                        } else {
                            console.warn('âš ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙ„Ø§Ø­ÙŠØ§Øª ÙÙŠ Supabase:', error?.message);
                        }
                    }

                    // âŒ Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©: Ø§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„Ù…Ø­Ù„ÙŠ - ØªÙ… Ø¥Ø²Ø§Ù„ØªÙ‡

                    // âœ… Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©: Ø¬Ù„Ø¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª ÙˆØ§Ù„ØªØµÙÙŠØ©
                    console.log('ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª ÙˆØ§Ù„ØªØµÙÙŠØ©...');
                    
                    if (window.supabase) {
                        const { data: allPrivileges, error } = await window.supabase
                            .from('privileges')
                            .select('*');
                        
                        if (!error && allPrivileges) {
                            const userPrivileges = allPrivileges.filter(priv => 
                                priv.user_id && priv.user_id.toString() === this.userId.toString()
                            );
                            
                            if (userPrivileges.length > 0) {
                                console.log(`âœ… ØªÙ… Ø¬Ù„Ø¨ ${userPrivileges.length} ØµÙ„Ø§Ø­ÙŠØ© Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø© ÙÙŠ Supabase`);
                                return userPrivileges;
                            }
                        }
                    }

                    // âœ… Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø©: Ø¥Ù†Ø´Ø§Ø¡ ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ© ÙÙŠ Supabase
                    console.log('ğŸ”„ Ø¥Ù†Ø´Ø§Ø¡ ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ© ÙÙŠ Supabase...');
                    return await this.createDefaultPrivileges();
                    
                } catch (error) {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª:', error);
                    // âœ… Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ø§Ù„Ù…Ø­Ù„ÙŠØ©
                    return null;
                }
            }

            // âœ… Ø¯Ø§Ù„Ø© Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© ÙÙŠ Supabase
            async createDefaultPrivileges() {
                try {
                    if (!window.supabase) {
                        console.warn('âš ï¸ Supabase ØºÙŠØ± Ù…ØªØ§Ø­ Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©');
                        return null;
                    }

                    const defaultScreens = [
                        'Ø§Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ù‚Ø³Ø§Ù…', 'Ø§Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†', 'Ø§Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…Ø±ØªØ¨Ø§Øª', 'Ø§Ø¯Ø®Ø§Ù„ Ø­Ø¶ÙˆØ± ÙˆØ§Ù†ØµØ±Ø§Ù',
                        'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†Ø´Ø£Ø©', 'Ø§ÙƒÙˆØ§Ø¯ Ø§Ù„ÙØ±ÙˆØ¹', 'Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„ÙˆØ­Ø¯Ø§Øª', 'Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ†', 
                        'Ø£ÙƒÙˆØ§Ø¯ Ø¹Ù…Ù„Ø§Ø¡', 'Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø§ØµÙ†Ø§Ù', 'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ØµÙ†Ø§Ù Ø¨Ø§Ù„ÙØ±ÙˆØ¹', 'ØªØ­ÙˆÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ÙØ±ÙˆØ¹',
                        'Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„ØªØ­ÙˆÙŠÙ„', 'Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø§Ø³Ø¹Ø§Ø±', 'Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª', 'Ù…Ø±ØªØ¬Ø¹ Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª',
                        'Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª', 'Ù…Ø±ØªØ¬Ø¹ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª', 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª', 'ØªÙ‚Ø±ÙŠØ± Ù…Ø±ØªØ¬Ø¹ Ù…Ø´ØªØ±ÙŠØ§Øª',
                        'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª', 'ØªÙ‚Ø±ÙŠØ± Ù…Ø±ØªØ¬Ø¹ Ù…Ø¨ÙŠØ¹Ø§Øª', 'ØªÙ‚Ø±ÙŠØ± Ø­Ø±ÙƒØ© Ø§Ù„ÙØ±ÙˆØ¹', 'ØªÙ‚Ø±ÙŠØ± ØªØ­ÙˆÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ÙØ±ÙˆØ¹',
                        'ØªÙ‚Ø±ÙŠØ± Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„ØªØ­ÙˆÙŠÙ„', 'ØªÙ‚Ø±ÙŠØ± Ø¬Ø±ÙˆØ¯ Ø§Ù„ÙØ±ÙˆØ¹', 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙƒØ§Ø´ÙŠØ±', 'Ø§ÙƒÙˆØ§Ø¯ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª',
                        'Ø´Ø¬Ø±Ø© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª', 'Ø­Ø±ÙƒØ© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª', 'Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠØ©', 'Ø¨Ø­Ø« Ø¨Ø§Ù„ÙƒÙˆØ¯ Ø§Ùˆ Ø¨Ø§Ù„Ø§Ø³Ù…',
                        'Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ù…ØªØ§Ø­Ù‡', 'Ø§Ø¯Ø®Ø§Ù„ Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ù†Ø¸Ø§Ù…', 'ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†', 'ØªÙ‚Ø±ÙŠØ± Ø¨ØªØ¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…'
                    ];

                    // âœ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© ÙÙŠ Supabase
                    const privilegesToInsert = defaultScreens.map(screenName => ({
                        user_id: this.userId,
                        priv_name: screenName,
                        description: `Ø´Ø§Ø´Ø© ${screenName}`,
                        can_view: true,  // âœ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¹Ø±Ø¶ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø´Ø§Ø´Ø§Øª
                        can_add: screenName.includes('Ø§Ø¯Ø®Ø§Ù„') || screenName.includes('Ø¥Ø¯Ø®Ø§Ù„'), // âœ… Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
                        can_edit: screenName.includes('Ø§Ø¯Ø®Ø§Ù„') || screenName.includes('Ø¥Ø¯Ø®Ø§Ù„'), // âœ… Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
                        can_delete: false // âŒ Ù„Ø§ Ø­Ø°Ù Ø§ÙØªØ±Ø§Ø¶ÙŠ
                    }));

                    const { data: newPrivileges, error: insertError } = await window.supabase
                        .from('privileges')
                        .insert(privilegesToInsert)
                        .select();

                    if (!insertError && newPrivileges) {
                        console.log(`âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ${newPrivileges.length} ØµÙ„Ø§Ø­ÙŠØ© Ø§ÙØªØ±Ø§Ø¶ÙŠØ© ÙÙŠ Supabase`);
                        
                        // âœ… Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ø£Ø®Ø±Ù‰ Ø¨Ø§Ù„ØªØ­Ø¯ÙŠØ«
                        localStorage.setItem('privileges_updated', Date.now());
                        
                        return newPrivileges;
                    } else {
                        console.error('âŒ ÙØ´Ù„ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©:', insertError);
                        return null;
                    }

                } catch (error) {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©:', error);
                    return null;
                }
            }

            // ğŸ§© ØªÙ†Ø¸ÙŠÙ… Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø­Ø³Ø¨ Ø§Ù„Ø´Ø§Ø´Ø§Øª
            organizePrivileges(privileges) {
                this.screenPermissions = {};
                
                privileges.forEach(priv => {
                    const screenName = priv.priv_name;
                    if (screenName) {
                        this.screenPermissions[screenName] = {
                            can_view: this.parseBoolean(priv.can_view),
                            can_add: this.parseBoolean(priv.can_add),
                            can_edit: this.parseBoolean(priv.can_edit),
                            can_delete: this.parseBoolean(priv.can_delete)
                        };
                    }
                });

                console.log('ğŸ—‚ï¸ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ù†Ø¸Ù…Ø©:', this.screenPermissions);
            }

            // ğŸ§© ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù‚ÙŠÙ… Ø¥Ù„Ù‰ boolean
            parseBoolean(value) {
                if (value === null || value === undefined) return false;
                if (typeof value === 'boolean') return value;
                if (typeof value === 'string') {
                    return value.toLowerCase() === 'true' || value === '1';
                }
                if (typeof value === 'number') {
                    return value === 1;
                }
                return Boolean(value);
            }

            // ğŸ§© Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£
            setDefaultPermissions() {
                console.log('ğŸ›¡ï¸ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©');
                
                const defaultScreens = {
                    // Ø´Ø¦ÙˆÙ† Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
                    'Ø§Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ù‚Ø³Ø§Ù…': { can_view: true, can_add: true, can_edit: true, can_delete: false },
                    'Ø§Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†': { can_view: true, can_add: true, can_edit: true, can_delete: false },
                    'Ø§Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…Ø±ØªØ¨Ø§Øª': { can_view: true, can_add: true, can_edit: true, can_delete: false },
                    'Ø§Ø¯Ø®Ø§Ù„ Ø­Ø¶ÙˆØ± ÙˆØ§Ù†ØµØ±Ø§Ù': { can_view: true, can_add: true, can_edit: true, can_delete: false },
                    
                    // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
                    'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†Ø´Ø£Ø©': { can_view: true, can_add: true, can_edit: true, can_delete: false },
                    'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø±ÙƒØ§Øª': { can_view: true, can_add: true, can_edit: true, can_delete: false },
                    'Ø§ÙƒÙˆØ§Ø¯ Ø§Ù„ÙØ±ÙˆØ¹': { can_view: true, can_add: true, can_edit: true, can_delete: false },
                    'Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„ÙˆØ­Ø¯Ø§Øª': { can_view: true, can_add: true, can_edit: true, can_delete: false },
                    'Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ†': { can_view: true, can_add: true, can_edit: true, can_delete: false },
                    'Ø£ÙƒÙˆØ§Ø¯ Ø¹Ù…Ù„Ø§Ø¡': { can_view: true, can_add: true, can_edit: true, can_delete: false },
                    'Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø§ØµÙ†Ø§Ù': { can_view: true, can_add: true, can_edit: true, can_delete: false },
                    'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ØµÙ†Ø§Ù Ø¨Ø§Ù„ÙØ±ÙˆØ¹': { can_view: true, can_add: true, can_edit: true, can_delete: false },
                    'ØªØ­ÙˆÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ÙØ±ÙˆØ¹': { can_view: true, can_add: true, can_edit: true, can_delete: false },
                    'Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„ØªØ­ÙˆÙŠÙ„': { can_view: true, can_add: true, can_edit: true, can_delete: false },
                    'Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø§Ø³Ø¹Ø§Ø±': { can_view: true, can_add: true, can_edit: true, can_delete: false },

                    // Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª
                    'Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª': { can_view: true, can_add: true, can_edit: true, can_delete: false },
                    'Ù…Ø±ØªØ¬Ø¹ Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª': { can_view: true, can_add: true, can_edit: true, can_delete: false },

                    // Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª
                    'Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª': { can_view: true, can_add: true, can_edit: true, can_delete: false },
                    'Ù…Ø±ØªØ¬Ø¹ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª': { can_view: true, can_add: true, can_edit: true, can_delete: false },

                    // Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±
                    'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª': { can_view: true, can_add: false, can_edit: false, can_delete: false },
                    'ØªÙ‚Ø±ÙŠØ± Ù…Ø±ØªØ¬Ø¹ Ù…Ø´ØªØ±ÙŠØ§Øª': { can_view: true, can_add: false, can_edit: false, can_delete: false },
                    'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª': { can_view: true, can_add: false, can_edit: false, can_delete: false },
                    'ØªÙ‚Ø±ÙŠØ± Ù…Ø±ØªØ¬Ø¹ Ù…Ø¨ÙŠØ¹Ø§Øª': { can_view: true, can_add: false, can_edit: false, can_delete: false },
                    'ØªÙ‚Ø±ÙŠØ± Ø­Ø±ÙƒØ© Ø§Ù„ÙØ±ÙˆØ¹': { can_view: true, can_add: false, can_edit: false, can_delete: false },
                    'ØªÙ‚Ø±ÙŠØ± ØªØ­ÙˆÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ÙØ±ÙˆØ¹': { can_view: true, can_add: false, can_edit: false, can_delete: false },
                    'ØªÙ‚Ø±ÙŠØ± Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„ØªØ­ÙˆÙŠÙ„': { can_view: true, can_add: false, can_edit: false, can_delete: false },
                    'ØªÙ‚Ø±ÙŠØ± Ø¬Ø±ÙˆØ¯ Ø§Ù„ÙØ±ÙˆØ¹': { can_view: true, can_add: false, can_edit: false, can_delete: false },
                    'ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙƒØ§Ø´ÙŠØ±': { can_view: true, can_add: false, can_edit: false, can_delete: false },
                    
                    // Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©
                    'Ø§ÙƒÙˆØ§Ø¯ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª': { can_view: true, can_add: true, can_edit: true, can_delete: false },
                    'Ø´Ø¬Ø±Ø© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª': { can_view: true, can_add: true, can_edit: true, can_delete: false },
                    'Ø­Ø±ÙƒØ© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª': { can_view: true, can_add: true, can_edit: true, can_delete: false },
                    'Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠØ©': { can_view: true, can_add: false, can_edit: false, can_delete: false },
                    
                    // Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
                    'Ø¨Ø­Ø« Ø¨Ø§Ù„ÙƒÙˆØ¯ Ø§Ùˆ Ø¨Ø§Ù„Ø§Ø³Ù…': { can_view: true, can_add: false, can_edit: false, can_delete: false },
                    'Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ù…ØªØ§Ø­Ù‡': { can_view: true, can_add: false, can_edit: false, can_delete: false },
                    'Ø§Ø¯Ø®Ø§Ù„ Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ù†Ø¸Ø§Ù…': { can_view: true, can_add: true, can_edit: true, can_delete: false },
                    'ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†': { can_view: true, can_add: true, can_edit: true, can_delete: false },
                    'ØªÙ‚Ø±ÙŠØ± Ø¨ØªØ¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…': { can_view: true, can_add: false, can_edit: false, can_delete: false }
                };

                this.screenPermissions = defaultScreens;
            }

            // ğŸ§© ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø¹Ù„Ù‰ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø­Ø³Ù†Ø©
            applyPermissionsToMenu() {
                
                const screenMappings = {
                    // Ø´Ø¦ÙˆÙ† Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
                    'dept-link': 'Ø§Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ù‚Ø³Ø§Ù…',
                    'empl-link': 'Ø§Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†',
                    'payroll-link': 'Ø§Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…Ø±ØªØ¨Ø§Øª',
                    'attend-link': 'Ø§Ø¯Ø®Ø§Ù„ Ø­Ø¶ÙˆØ± ÙˆØ§Ù†ØµØ±Ø§Ù',
                    
                    // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
                    'company-link': 'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†Ø´Ø£Ø©',
                    'stores-link': 'Ø§ÙƒÙˆØ§Ø¯ Ø§Ù„ÙØ±ÙˆØ¹',
                    'unit-link': 'Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„ÙˆØ­Ø¯Ø§Øª',
                    'suppliers-link': 'Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ†',
                    'customer-link': 'Ø£ÙƒÙˆØ§Ø¯ Ø¹Ù…Ù„Ø§Ø¡',
                    'items-link': 'Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø§ØµÙ†Ø§Ù',
                    'master-link': 'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ØµÙ†Ø§Ù Ø¨Ø§Ù„ÙØ±ÙˆØ¹',
                    'transferItem-link': 'ØªØ­ÙˆÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ÙØ±ÙˆØ¹',
                    'acceptTransfer-link': 'Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„ØªØ­ÙˆÙŠÙ„',
                    'offers-link': 'Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø§Ø³Ø¹Ø§Ø±',

                    // Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª
                    'purchases-link': 'Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª',
                    'purchases_ret-link': 'Ù…Ø±ØªØ¬Ø¹ Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª',

                    // Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª
                    'sales-link': 'Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª',
                    'salesreturn-link': 'Ù…Ø±ØªØ¬Ø¹ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª',

                    // Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±
                    'purchases_rep-link': 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª',
                    'purchase_return_rep-link': 'ØªÙ‚Ø±ÙŠØ± Ù…Ø±ØªØ¬Ø¹ Ù…Ø´ØªØ±ÙŠØ§Øª',
                    'sales_report-link': 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª',
                    'salesreturn_rep-link': 'ØªÙ‚Ø±ÙŠØ± Ù…Ø±ØªØ¬Ø¹ Ù…Ø¨ÙŠØ¹Ø§Øª',
                    'masterrep': 'ØªÙ‚Ø±ÙŠØ± Ø­Ø±ÙƒØ© Ø§Ù„ÙØ±ÙˆØ¹',
                    'transferReport-link': 'ØªÙ‚Ø±ÙŠØ± ØªØ­ÙˆÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ÙØ±ÙˆØ¹',
                    'accptRep-link': 'ØªÙ‚Ø±ÙŠØ± Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„ØªØ­ÙˆÙŠÙ„',
                    'inventoryrep-link': 'ØªÙ‚Ø±ÙŠØ± Ø¬Ø±ÙˆØ¯ Ø§Ù„ÙØ±ÙˆØ¹',
                    'dailyCashier-link': 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙƒØ§Ø´ÙŠØ±',

                    // Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©
                    'acc_type-link': 'Ø§ÙƒÙˆØ§Ø¯ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª',
                    'account-link': 'Ø´Ø¬Ø±Ø© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª',
                    'acc_transaction-link': 'Ø­Ø±ÙƒØ© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª',
                    'account_report-link': 'Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠØ©',

                    // Ø§Ù„Ø¨Ø­Ø«
                    'search-link': 'Ø¨Ø­Ø« Ø¨Ø§Ù„ÙƒÙˆØ¯ Ø§Ùˆ Ø¨Ø§Ù„Ø§Ø³Ù…',
                    'offershow-link': 'Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ù…ØªØ§Ø­Ù‡',

                    // Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
                    'user-link': 'Ø§Ø¯Ø®Ø§Ù„ Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ù†Ø¸Ø§Ù…',
                    'privileges-link': 'ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†',
                    'user_active_rep-link': 'ØªÙ‚Ø±ÙŠØ± Ø¨ØªØ¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…'
                };

                let enabledLinks = 0;
                let totalLinks = 0;
                let missingPermissions = [];

                // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø¹Ù„Ù‰ ÙƒÙ„ Ø±Ø§Ø¨Ø·
                Object.entries(screenMappings).forEach(([linkId, screenName]) => {
                    const link = document.getElementById(linkId);
                    totalLinks++;

                    if (link) {
                        const permissions = this.screenPermissions[screenName];
                        
                        if (!permissions) {
                            missingPermissions.push(screenName);
                        }
                        
                        // âœ… Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø¥Ø¶Ø§ÙÙŠ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„ÙØ±ÙˆØ¹ Ù„Ù„ØªØ­ÙˆÙŠÙ„ ÙˆØ§Ù„Ø§Ø³ØªÙ„Ø§Ù…
                        if (screenName === 'ØªØ­ÙˆÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ÙØ±ÙˆØ¹' || screenName === 'Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„ØªØ­ÙˆÙŠÙ„') {
                            const hasBranchPermission = this.checkBranchTransferPermissions(screenName);
                            
                            if (!permissions || !permissions.can_view || !hasBranchPermission) {
                                link.classList.add('disabled-link');
                                link.title = 'ğŸš« Ù„Ø§ ØªÙ…Ù„Ùƒ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù‡Ø°Ù‡ Ø§Ù„Ø´Ø§Ø´Ø©';
                                console.log(`ğŸš« Ù…Ø¹Ø·Ù„: ${screenName} - ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„ÙØ±Ø¹: ${hasBranchPermission}`);
                            } else {
                                enabledLinks++;
                                link.classList.remove('disabled-link');
                                link.title = `âœ… Ù…Ø³Ù…ÙˆØ­ - ${this.getPermissionText(permissions)}`;
                                this.addPermissionIndicator(link, permissions);
                                console.log(`âœ… Ù…ÙØ¹Ù„: ${screenName}`);
                            }
                        } else {
                            // âœ… Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ø¹Ø§Ø¯ÙŠØ© Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ø£Ø®Ø±Ù‰
                            if (!permissions || !permissions.can_view) {
                                link.classList.add('disabled-link');
                                link.title = 'ğŸš« Ù„Ø§ ØªÙ…Ù„Ùƒ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù‡Ø°Ù‡ Ø§Ù„Ø´Ø§Ø´Ø©';
                                console.log(`ğŸš« Ù…Ø¹Ø·Ù„: ${screenName}`);
                            } else {
                                enabledLinks++;
                                link.classList.remove('disabled-link');
                                link.title = `âœ… Ù…Ø³Ù…ÙˆØ­ - ${this.getPermissionText(permissions)}`;
                                this.addPermissionIndicator(link, permissions);
                                console.log(`âœ… Ù…ÙØ¹Ù„: ${screenName}`);
                            }
                        }
                    } else {
                        console.warn(`âš ï¸ Ø±Ø§Ø¨Ø· ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯: ${linkId} - ${screenName}`);
                    }
                });

                console.log(`ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª: ${enabledLinks}/${totalLinks} Ø±Ø§Ø¨Ø· Ù…ÙØ¹Ù„`);
                console.log(`ğŸª ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„ÙØ±Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ:`, this.branchPermissions);
                
                // âœ… Ø¹Ø±Ø¶ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØªÙŠ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù„Ù‡Ø§ ØµÙ„Ø§Ø­ÙŠØ§Øª
                if (missingPermissions.length > 0) {
                    console.warn('âŒ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØªÙŠ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù„Ù‡Ø§ ØµÙ„Ø§Ø­ÙŠØ§Øª:', missingPermissions);
                }
                
                this.hideEmptySections();
            }

            // âœ… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ÙØ±ÙˆØ¹
            checkBranchTransferPermissions(screenName) {
                if (screenName === 'ØªØ­ÙˆÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ÙØ±ÙˆØ¹') {
                    return this.branchPermissions.can_transfer === true;
                } else if (screenName === 'Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„ØªØ­ÙˆÙŠÙ„') {
                    return this.branchPermissions.can_receive === true;
                }
                return false;
            }

            // ğŸ§© Ø¥Ø¶Ø§ÙØ© Ù…Ø¤Ø´Ø± Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
            addPermissionIndicator(link, permissions) {
                // Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ Ù…Ø¤Ø´Ø±Ø§Øª Ø³Ø§Ø¨Ù‚Ø©
                const existingIndicator = link.querySelector('.permission-indicator');
                if (existingIndicator) {
                    existingIndicator.remove();
                }
                
                const indicator = document.createElement('span');
                indicator.className = 'permission-indicator';
                
                let indicators = [];
                if (permissions.can_add) indicators.push('+');
                if (permissions.can_edit) indicators.push('âœï¸');
                if (permissions.can_delete) indicators.push('ğŸ—‘ï¸');
                
                if (indicators.length > 0) {
                    indicator.textContent = `[${indicators.join('')}]`;
                    link.insertBefore(indicator, link.firstChild);
                }
            }

            // ğŸ§© Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù†Øµ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
            getPermissionText(permissions) {
                const parts = [];
                if (permissions.can_view) parts.push('Ø¹Ø±Ø¶');
                if (permissions.can_add) parts.push('Ø¥Ø¶Ø§ÙØ©');
                if (permissions.can_edit) parts.push('ØªØ¹Ø¯ÙŠÙ„');
                if (permissions.can_delete) parts.push('Ø­Ø°Ù');
                return parts.length > 0 ? parts.join('ØŒ ') : 'Ø¹Ø±Ø¶ ÙÙ‚Ø·';
            }

            // ğŸ§© Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„ÙØ§Ø±ØºØ©
            hideEmptySections() {
                const dropdowns = document.querySelectorAll('.dropdown');
                dropdowns.forEach(dropdown => {
                    const dropbtn = dropdown.querySelector('.dropbtn');
                    const links = dropdown.querySelectorAll('.dropdown-content a:not(.disabled-link)');
                    
                    // âœ… Ù‚Ø³Ù… Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ - Ù„Ø§ ØªØ®ÙÙŠÙ‡ Ø£Ø¨Ø¯Ø§Ù‹
                    if (dropbtn && dropbtn.textContent.includes('Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬')) {
                        console.log('âš™ï¸ Ù‚Ø³Ù… Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ - Ø¥Ø¸Ù‡Ø§Ø± Ø¯Ø§Ø¦Ù…Ø§Ù‹');
                        dropdown.style.display = 'block';
                        return;
                    }
                    
                    // âœ… Ù‚Ø³Ù… Ø­ÙˆÙ„ - Ù„Ø§ ØªØ®ÙÙŠÙ‡ Ø£Ø¨Ø¯Ø§Ù‹
                    if (dropbtn && dropbtn.textContent.includes('Ø­ÙˆÙ„')) {
                        console.log('â„¹ï¸ Ù‚Ø³Ù… Ø­ÙˆÙ„ - Ø¥Ø¸Ù‡Ø§Ø± Ø¯Ø§Ø¦Ù…Ø§Ù‹');
                        dropdown.style.display = 'block';
                        return;
                    }
                    
                    if (links.length === 0) {
                        console.log(`ğŸ‘ï¸ Ø¥Ø®ÙØ§Ø¡ Ù‚Ø³Ù…: ${dropbtn?.textContent}`);
                        dropdown.style.display = 'none';
                    } else {
                        console.log(`âœ… Ø¥Ø¸Ù‡Ø§Ø± Ù‚Ø³Ù…: ${dropbtn?.textContent} (${links.length} Ø±Ø§Ø¨Ø·)`);
                        dropdown.style.display = 'block';
                    }
                });
            }

            // ğŸ§© ØªØ´Ø®ÙŠØµ Ù…Ø´ÙƒÙ„Ø© Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
            diagnosePrivileges() {
                console.log('ğŸ” ØªØ´Ø®ÙŠØµ Ù…Ø´ÙƒÙ„Ø© Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª...');
                
                const screenMappings = {
                    'dept-link': 'Ø§Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ù‚Ø³Ø§Ù…',
                    'empl-link': 'Ø§Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†',
                    'payroll-link': 'Ø§Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…Ø±ØªØ¨Ø§Øª',
                    'attend-link': 'Ø§Ø¯Ø®Ø§Ù„ Ø­Ø¶ÙˆØ± ÙˆØ§Ù†ØµØ±Ø§Ù',
                    'company-link': 'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†Ø´Ø£Ø©',
                    'stores-link': 'Ø§ÙƒÙˆØ§Ø¯ Ø§Ù„ÙØ±ÙˆØ¹',
                    'unit-link': 'Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„ÙˆØ­Ø¯Ø§Øª',
                    'suppliers-link': 'Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ†',
                    'customer-link': 'Ø£ÙƒÙˆØ§Ø¯ Ø¹Ù…Ù„Ø§Ø¡',
                    'items-link': 'Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø§ØµÙ†Ø§Ù',
                    'master-link': 'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ØµÙ†Ø§Ù Ø¨Ø§Ù„ÙØ±ÙˆØ¹',
                    'transferItem-link': 'ØªØ­ÙˆÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ÙØ±ÙˆØ¹',
                    'acceptTransfer-link': 'Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„ØªØ­ÙˆÙŠÙ„',
                    'offers-link': 'Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø§Ø³Ø¹Ø§Ø±',
                    'purchases-link': 'Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª',
                    'purchases_ret-link': 'Ù…Ø±ØªØ¬Ø¹ Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª',
                    'sales-link': 'Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª',
                    'salesreturn-link': 'Ù…Ø±ØªØ¬Ø¹ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª',
                    'purchases_rep-link': 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª',
                    'purchase_return_rep-link': 'ØªÙ‚Ø±ÙŠØ± Ù…Ø±ØªØ¬Ø¹ Ù…Ø´ØªØ±ÙŠØ§Øª',
                    'sales_report-link': 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª',
                    'salesreturn_rep-link': 'ØªÙ‚Ø±ÙŠØ± Ù…Ø±ØªØ¬Ø¹ Ù…Ø¨ÙŠØ¹Ø§Øª',
                    'masterrep': 'ØªÙ‚Ø±ÙŠØ± Ø­Ø±ÙƒØ© Ø§Ù„ÙØ±ÙˆØ¹',
                    'transferReport-link': 'ØªÙ‚Ø±ÙŠØ± ØªØ­ÙˆÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ÙØ±ÙˆØ¹',
                    'accptRep-link': 'ØªÙ‚Ø±ÙŠØ± Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„ØªØ­ÙˆÙŠÙ„',
                    'inventoryrep-link': 'ØªÙ‚Ø±ÙŠØ± Ø¬Ø±ÙˆØ¯ Ø§Ù„ÙØ±ÙˆØ¹',
                    'dailyCashier-link': 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙƒØ§Ø´ÙŠØ±',
                    'acc_type-link': 'Ø§ÙƒÙˆØ§Ø¯ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª',
                    'account-link': 'Ø´Ø¬Ø±Ø© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª',
                    'acc_transaction-link': 'Ø­Ø±ÙƒØ© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª',
                    'account_report-link': 'Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠØ©',
                    'search-link': 'Ø¨Ø­Ø« Ø¨Ø§Ù„ÙƒÙˆØ¯ Ø§Ùˆ Ø¨Ø§Ù„Ø§Ø³Ù…',
                    'offershow-link': 'Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ù…ØªØ§Ø­Ù‡',
                    'user-link': 'Ø§Ø¯Ø®Ø§Ù„ Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ù†Ø¸Ø§Ù…',
                    'privileges-link': 'ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†',
                    'user_active_rep-link': 'ØªÙ‚Ø±ÙŠØ± Ø¨ØªØ¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…'
                };

                console.log('ğŸ“‹ Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø´Ø§Ø´Ø§Øª ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©:');
                Object.values(screenMappings).forEach(screenName => {
                    const hasPermission = this.screenPermissions[screenName];
                    console.log(`   ${hasPermission ? 'âœ…' : 'âŒ'} ${screenName}: ${hasPermission ? 'Ù…ÙˆØ¬ÙˆØ¯' : 'Ù…ÙÙ‚ÙˆØ¯'}`);
                });

                console.log('ğŸ—‚ï¸ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…:');
                Object.keys(this.screenPermissions).forEach(screenName => {
                    console.log(`   ğŸ“Œ ${screenName}`);
                });

                // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¹Ø¯Ù… Ø§Ù„ØªØ·Ø§Ø¨Ù‚
                Object.entries(screenMappings).forEach(([linkId, screenName]) => {
                    if (!this.screenPermissions[screenName]) {
                        console.warn(`âš ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙ„Ø§Ø­ÙŠØ§Øª Ù„Ù„Ø´Ø§Ø´Ø©: "${screenName}" (Ø±Ø§Ø¨Ø·: ${linkId})`);
                    }
                });
            }

            // âœ… Ø¥ØµÙ„Ø§Ø­ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…ÙÙ‚ÙˆØ¯Ø©
            async fixMissingPermissions() {
                try {
                    console.log('ğŸ”§ Ù…Ø­Ø§ÙˆÙ„Ø© Ø¥ØµÙ„Ø§Ø­ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…ÙÙ‚ÙˆØ¯Ø©...');
                    
                    if (!window.supabase) {
                        console.warn('âš ï¸ Supabase ØºÙŠØ± Ù…ØªØ§Ø­ Ù„Ù„Ø¥ØµÙ„Ø§Ø­ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ');
                        alert('âŒ Supabase ØºÙŠØ± Ù…ØªØ§Ø­ Ù„Ù„Ø¥ØµÙ„Ø§Ø­ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ');
                        return;
                    }

                    const screenMappings = {
                        'dept-link': 'Ø§Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ù‚Ø³Ø§Ù…',
                        'empl-link': 'Ø§Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†',
                        'payroll-link': 'Ø§Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…Ø±ØªØ¨Ø§Øª',
                        'attend-link': 'Ø§Ø¯Ø®Ø§Ù„ Ø­Ø¶ÙˆØ± ÙˆØ§Ù†ØµØ±Ø§Ù',
                        'company-link': 'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†Ø´Ø£Ø©',
                        'stores-link': 'Ø§ÙƒÙˆØ§Ø¯ Ø§Ù„ÙØ±ÙˆØ¹',
                        'unit-link': 'Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„ÙˆØ­Ø¯Ø§Øª',
                        'suppliers-link': 'Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ†',
                        'customer-link': 'Ø£ÙƒÙˆØ§Ø¯ Ø¹Ù…Ù„Ø§Ø¡',
                        'items-link': 'Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø§ØµÙ†Ø§Ù',
                        'master-link': 'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ØµÙ†Ø§Ù Ø¨Ø§Ù„ÙØ±ÙˆØ¹',
                        'transferItem-link': 'ØªØ­ÙˆÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ÙØ±ÙˆØ¹',
                        'acceptTransfer-link': 'Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„ØªØ­ÙˆÙŠÙ„',
                        'offers-link': 'Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø§Ø³Ø¹Ø§Ø±',
                        'purchases-link': 'Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª',
                        'purchases_ret-link': 'Ù…Ø±ØªØ¬Ø¹ Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª',
                        'sales-link': 'Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª',
                        'salesreturn-link': 'Ù…Ø±ØªØ¬Ø¹ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª',
                        'purchases_rep-link': 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª',
                        'purchase_return_rep-link': 'ØªÙ‚Ø±ÙŠØ± Ù…Ø±ØªØ¬Ø¹ Ù…Ø´ØªØ±ÙŠØ§Øª',
                        'sales_report-link': 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª',
                        'salesreturn_rep-link': 'ØªÙ‚Ø±ÙŠØ± Ù…Ø±ØªØ¬Ø¹ Ù…Ø¨ÙŠØ¹Ø§Øª',
                        'masterrep': 'ØªÙ‚Ø±ÙŠØ± Ø­Ø±ÙƒØ© Ø§Ù„ÙØ±ÙˆØ¹',
                        'transferReport-link': 'ØªÙ‚Ø±ÙŠØ± ØªØ­ÙˆÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ÙØ±ÙˆØ¹',
                        'accptRep-link': 'ØªÙ‚Ø±ÙŠØ± Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„ØªØ­ÙˆÙŠÙ„',
                        'inventoryrep-link': 'ØªÙ‚Ø±ÙŠØ± Ø¬Ø±ÙˆØ¯ Ø§Ù„ÙØ±ÙˆØ¹',
                        'dailyCashier-link': 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙƒØ§Ø´ÙŠØ±',
                        'acc_type-link': 'Ø§ÙƒÙˆØ§Ø¯ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª',
                        'account-link': 'Ø´Ø¬Ø±Ø© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª',
                        'acc_transaction-link': 'Ø­Ø±ÙƒØ© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª',
                        'account_report-link': 'Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠØ©',
                        'search-link': 'Ø¨Ø­Ø« Ø¨Ø§Ù„ÙƒÙˆØ¯ Ø§Ùˆ Ø¨Ø§Ù„Ø§Ø³Ù…',
                        'offershow-link': 'Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ù…ØªØ§Ø­Ù‡',
                        'user-link': 'Ø§Ø¯Ø®Ø§Ù„ Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ù†Ø¸Ø§Ù…',
                        'privileges-link': 'ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†',
                        'user_active_rep-link': 'ØªÙ‚Ø±ÙŠØ± Ø¨ØªØ¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…'
                    };

                    let fixedCount = 0;

                    for (const [linkId, screenName] of Object.entries(screenMappings)) {
                        // Ø§Ù„ØªØ­Ù‚Ù‚ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ© Ù…ÙÙ‚ÙˆØ¯Ø©
                        if (!this.screenPermissions[screenName]) {
                            console.log(`ğŸ”„ Ø¥Ø¶Ø§ÙØ© ØµÙ„Ø§Ø­ÙŠØ© Ù…ÙÙ‚ÙˆØ¯Ø©: ${screenName}`);
                            
                            // Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© ÙÙŠ Supabase
                            const { error } = await window.supabase
                                .from('privileges')
                                .insert([{
                                    user_id: this.userId,
                                    priv_name: screenName,
                                    description: `Ø´Ø§Ø´Ø© ${screenName}`,
                                    can_view: true,
                                    can_add: true,
                                    can_edit: true,
                                    can_delete: false
                                }]);

                            if (!error) {
                                fixedCount++;
                                console.log(`âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© ØµÙ„Ø§Ø­ÙŠØ©: ${screenName}`);
                            } else {
                                console.warn(`âš ï¸ ÙØ´Ù„ Ø¥Ø¶Ø§ÙØ© ØµÙ„Ø§Ø­ÙŠØ©: ${screenName}`, error);
                            }
                        }
                    }

                    if (fixedCount > 0) {
                        console.log(`âœ… ØªÙ… Ø¥ØµÙ„Ø§Ø­ ${fixedCount} ØµÙ„Ø§Ø­ÙŠØ© Ù…ÙÙ‚ÙˆØ¯Ø©`);
                        alert(`âœ… ØªÙ… Ø¥ØµÙ„Ø§Ø­ ${fixedCount} ØµÙ„Ø§Ø­ÙŠØ© Ù…ÙÙ‚ÙˆØ¯Ø©`);
                        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
                        await this.loadUserPrivileges();
                        this.applyPermissionsToMenu();
                    } else {
                        console.log('âœ… Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙ„Ø§Ø­ÙŠØ§Øª Ù…ÙÙ‚ÙˆØ¯Ø© ØªØ­ØªØ§Ø¬ Ù„Ù„Ø¥ØµÙ„Ø§Ø­');
                        alert('âœ… Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙ„Ø§Ø­ÙŠØ§Øª Ù…ÙÙ‚ÙˆØ¯Ø© ØªØ­ØªØ§Ø¬ Ù„Ù„Ø¥ØµÙ„Ø§Ø­');
                    }

                } catch (error) {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø¥ØµÙ„Ø§Ø­ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª:', error);
                    alert('âŒ ÙØ´Ù„ ÙÙŠ Ø¥ØµÙ„Ø§Ø­ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª: ' + error.message);
                }
            }

            setupEventListeners() {
                // Ù…Ù†Ø¹ ÙØªØ­ Ø§Ù„Ù†ÙˆØ§ÙØ° Ù„Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù…Ø¹Ø·Ù„Ø©
                document.querySelectorAll('.dropdown-content a').forEach(link => {
                    link.addEventListener('click', (e) => {
                        if (link.classList.contains('disabled-link')) {
                            e.preventDefault();
                            alert('ğŸš« Ù„Ø§ ØªÙ…Ù„Ùƒ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù‡Ø°Ù‡ Ø§Ù„Ø´Ø§Ø´Ø©');
                            return;
                        }

                        // ÙØªØ­ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ù…Ø¹ Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø¹Ø¯Ø¯ Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…ÙØªÙˆØ­Ø©
                        e.preventDefault();
                        this.openNewWindow(link.href);
                    });
                });

                // Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø©
                document.querySelectorAll('.dropbtn').forEach(button => {
                    button.addEventListener('click', function() {
                        const dropdowns = document.querySelectorAll('.dropdown-content');
                        dropdowns.forEach(dropdown => {
                            if (dropdown !== this.nextElementSibling) {
                                dropdown.style.display = 'none';
                            }
                        });
                        const content = this.nextElementSibling;
                        content.style.display = content.style.display === 'block' ? 'none' : 'block';
                    });
                });

                // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§
                window.addEventListener('click', (event) => {
                    if (!event.target.matches('.dropbtn')) {
                        const dropdowns = document.querySelectorAll('.dropdown-content');
                        dropdowns.forEach(dropdown => {
                            dropdown.style.display = 'none';
                        });
                    }
                });

                // Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø« Ø§Ù„Ù†Ù‚Ø± Ù„Ø²Ø± ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
                document.getElementById('refreshPermissionsBtn').addEventListener('click', () => {
                    this.refreshPermissions();
                });

                // Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø« Ø§Ù„Ù†Ù‚Ø± Ù„Ø²Ø± Ø¥ØµÙ„Ø§Ø­ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
                document.getElementById('fixPermissionsBtn').addEventListener('click', () => {
                    this.fixMissingPermissions();
                });

                // Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø« Ø§Ù„Ù†Ù‚Ø± Ù„Ø²Ø± Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
                document.getElementById('createDefaultPrivilegesBtn').addEventListener('click', async () => {
                    const result = await this.createDefaultPrivileges();
                    if (result) {
                        alert('âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­!');
                        await this.loadUserPrivileges();
                        this.applyPermissionsToMenu();
                    } else {
                        alert('âŒ ÙØ´Ù„ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©');
                    }
                });
            }

            // ğŸ§© ÙØªØ­ Ù†ÙˆØ§ÙØ° Ø¬Ø¯ÙŠØ¯Ø© Ù…Ø¹ Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ø¹Ø¯Ø¯
            openNewWindow(url) {
                // ØªØ­Ù‚Ù‚ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù†Ø§ÙØ°Ø© Ù…ÙˆØ¬ÙˆØ¯Ø© Ø¨Ø§Ù„ÙØ¹Ù„
                const existingWindow = openWindows.find(w => w.url === url && !w.window.closed);

                if (existingWindow) {
                    alert("âš ï¸ Ù‡Ø°Ù‡ Ø§Ù„Ø´Ø§Ø´Ø© Ù…ÙØªÙˆØ­Ø© Ø¨Ø§Ù„ÙØ¹Ù„!");
                    existingWindow.window.focus();
                    return;
                }

                // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù†ÙˆØ§ÙØ° Ø£ÙƒØ«Ø± Ù…Ù† 4 Ø£ØºÙ„Ù‚ Ø§Ù„Ø£Ù‚Ø¯Ù…
                while (openWindows.length >= 4) {
                    const oldWindow = openWindows.shift();
                    if (oldWindow && !oldWindow.window.closed) {
                        oldWindow.window.close();
                    }
                }

                // ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø¬Ø¯ÙŠØ¯Ø©
                const newWindow = window.open(url, '_blank');

                if (newWindow) {
                    openWindows.push({ url: url, window: newWindow });
                    console.log('ğŸªŸ Ù†ÙˆØ§ÙØ° Ù…ÙØªÙˆØ­Ø©:', openWindows.length);
                }
            }

            // ğŸ§© ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            updateUserInfo() {
                const username = localStorage.getItem('username') || sessionStorage.getItem('username');
                const storeName = localStorage.getItem('store_name') || sessionStorage.getItem('store_name');

                if (username) {
                    document.getElementById('username').textContent = 'Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ' + username;
                }

                if (storeName) {
                    document.getElementById('store-name').textContent = 'Ø§Ø³Ù… Ø§Ù„ÙØ±Ø¹: ' + storeName;
                }

                this.updateDate();
            }

            // ğŸ§© ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ§Ø±ÙŠØ®
            updateDate() {
                const currentDate = new Date().toLocaleDateString('ar-EG', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
                document.getElementById('current-date').textContent = 'ØªØ§Ø±ÙŠØ® Ø§Ù„ÙŠÙˆÙ…: ' + currentDate;
            }

            // âœ… ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª ÙŠØ¯ÙˆÙŠØ§Ù‹
            async refreshPermissions() {
                console.log('ğŸ”„ Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª...');
                document.getElementById('user-privileges-status').textContent = 'ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ø¯ÙŠØ«...';
                
                await this.loadUserPrivileges();
                await this.loadBranchPermissions();
                this.applyPermissionsToMenu();
                
                document.getElementById('user-privileges-status').textContent = 'âœ… ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ«';
                setTimeout(() => {
                    document.getElementById('user-privileges-status').textContent = 'âœ… Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ù…Ø­Ù…Ù„Ø©';
                }, 2000);
            }

            // ğŸ§© ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
            initializeStats() {
                // Ù…Ø­Ø§ÙƒØ§Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ø­ØµØ§Ø¦ÙŠØ© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©
                const salesCount = Math.floor(Math.random() * 50) + 10;
                const purchasesCount = Math.floor(Math.random() * 30) + 5;
                const inventoryCount = Math.floor(Math.random() * 500) + 100;
                const employeesCount = Math.floor(Math.random() * 50) + 20;
                
                // ØªØ£Ø«ÙŠØ± Ø¹Ø¯ Ù…ØªØ­Ø±Ùƒ Ù„Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
                this.animateValue('sales-count', 0, salesCount, 1500);
                this.animateValue('purchases-count', 0, purchasesCount, 1500);
                this.animateValue('inventory-count', 0, inventoryCount, 1500);
                this.animateValue('employees-count', 0, employeesCount, 1500);
            }

            // ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¹Ø¯ Ø§Ù„Ù…ØªØ­Ø±Ùƒ
            animateValue(id, start, end, duration) {
                const obj = document.getElementById(id);
                let startTimestamp = null;
                const step = (timestamp) => {
                    if (!startTimestamp) startTimestamp = timestamp;
                    const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                    const value = Math.floor(progress * (end - start) + start);
                    obj.innerHTML = value.toLocaleString();
                    if (progress < 1) {
                        window.requestAnimationFrame(step);
                    }
                };
                window.requestAnimationFrame(step);
            }
        }

        // ğŸ§© ØªØ´Ø®ÙŠØµ Ù…Ø´ÙƒÙ„Ø© Ø§Ù„Ù‚ÙˆØ§Ø¦Ù…
        function diagnoseMenu() {
            console.log('ğŸ” ØªØ´Ø®ÙŠØµ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©...');
            
            const dropdowns = document.querySelectorAll('.dropdown');
            console.log(`ğŸ“Š Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…: ${dropdowns.length}`);
            
            dropdowns.forEach((dropdown, index) => {
                const dropbtn = dropdown.querySelector('.dropbtn');
                const content = dropdown.querySelector('.dropdown-content');
                const links = content ? content.querySelectorAll('a') : [];
                const enabledLinks = content ? content.querySelectorAll('a:not(.disabled-link)') : [];
                
                console.log(`\nğŸ“¦ Ø§Ù„Ù‚Ø³Ù… ${index + 1}:`);
                console.log(`   Ø§Ù„Ù†Øµ: ${dropbtn?.textContent}`);
                console.log(`   Ø§Ù„Ø¹Ø±Ø¶: ${dropdown.style.display}`);
                console.log(`   Ø§Ù„Ø±ÙˆØ§Ø¨Ø·: ${links.length} (Ù…ÙØ¹Ù„: ${enabledLinks.length})`);
            });

            // âœ… ØªØ´Ø®ÙŠØµ Ø®Ø§Øµ Ù„Ù„ØªØ­ÙˆÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ÙØ±ÙˆØ¹
            const transferLink = document.getElementById('transferItem-link');
            const receiveLink = document.getElementById('acceptTransfer-link');
            
            console.log('\nğŸ” ØªØ´Ø®ÙŠØµ Ø®Ø§Øµ Ø¨Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ÙØ±ÙˆØ¹:');
            console.log(`   Ø±Ø§Ø¨Ø· Ø§Ù„ØªØ­ÙˆÙŠÙ„: ${transferLink ? (transferLink.classList.contains('disabled-link') ? 'ğŸš« Ù…Ø¹Ø·Ù„' : 'âœ… Ù…ÙØ¹Ù„') : 'âŒ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯'}`);
            console.log(`   Ø±Ø§Ø¨Ø· Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…: ${receiveLink ? (receiveLink.classList.contains('disabled-link') ? 'ğŸš« Ù…Ø¹Ø·Ù„' : 'âœ… Ù…ÙØ¹Ù„') : 'âŒ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯'}`);
        }

        // ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ´Ø®ÙŠØµ Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                diagnoseMenu();
            }, 1000);
        });

        // ğŸ§© ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', () => {
            console.log('ğŸš€ Ø¨Ø¯Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©...');
            window.mainMenuManager = new MainMenuManager();

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ§Ø±ÙŠØ® ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø©
            setInterval(() => {
                if (window.mainMenuManager) {
                    window.mainMenuManager.updateDate();
                }
            }, 60000);
        });

        // âœ… ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ù…Ø¨Ø§Ø´Ø±Ø© Ø¨Ø¯ÙˆÙ† Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        window.addEventListener('storage', (event) => {
            if (event.key === 'privileges_updated' || event.key === 'branch_permissions_updated') {
                console.log('ğŸ”„ ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª');
                if (window.mainMenuManager) {
                    window.mainMenuManager.loadUserPrivileges().then(() => {
                        window.mainMenuManager.loadBranchPermissions().then(() => {
                            window.mainMenuManager.applyPermissionsToMenu();
                            window.mainMenuManager.hideEmptySections();
                        });
                    });
                }
            }
        });
    </script>
</body>
</html>