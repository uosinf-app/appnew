<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ğŸ‘¨â€ğŸ’¼ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ‘¨â€ğŸ’¼</text></svg>" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <style>
    :root {
      --primary-color: #3498db;
      --secondary-color: #2c3e50;
      --accent-color: #1abc9c;
      --light-color: #f5f7fa;
      --dark-color: #34495e;
      --success-color: #2ecc71;
      --warning-color: #f39c12;
      --danger-color: #e74c3c;
      --border-radius: 12px;
      --box-shadow: 0 6px 15px rgba(0, 0, 0, 0.08);
      --transition: all 0.3s ease;
      --gradient-primary: linear-gradient(135deg, #3498db, #1abc9c);
      --gradient-secondary: linear-gradient(135deg, #2c3e50, #34495e);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height: 1.6;
      color: #333;
      background: linear-gradient(135deg, #f5f7fa 0%, #e4e8ed 100%);
      padding: 20px;
      min-height: 100vh;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    .header {
      background: var(--gradient-primary);
      color: white;
      padding: 25px;
      border-radius: var(--border-radius);
      margin-bottom: 25px;
      text-align: center;
      box-shadow: var(--box-shadow);
      position: relative;
      overflow: hidden;
    }

    .header::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="none"><path d="M0,0 L100,0 L100,100 Z" fill="rgba(255,255,255,0.1)"/></svg>');
      background-size: cover;
    }

    .header h2 {
      font-size: 2.2rem;
      margin: 0;
      position: relative;
      z-index: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
    }

    .connection-status {
      position: fixed;
      top: 15px;
      left: 15px;
      background: white;
      padding: 10px 15px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      z-index: 1000;
      font-size: 14px;
      display: flex;
      align-items: center;
      gap: 8px;
      border-left: 4px solid #28a745;
      transition: var(--transition);
    }

    .loading-spinner {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 9999;
    }

    .main-content {
      display: grid;
      grid-template-columns: 1fr 1.5fr;
      gap: 25px;
      margin-top: 20px;
    }

    @media (max-width: 1024px) {
      .main-content {
        grid-template-columns: 1fr;
      }
    }

    .card {
      background: white;
      border-radius: var(--border-radius);
      padding: 25px;
      box-shadow: var(--box-shadow);
      transition: var(--transition);
      border: none;
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 25px rgba(0, 0, 0, 0.15);
    }

    .card-title {
      font-size: 1.4rem;
      margin-bottom: 20px;
      color: var(--secondary-color);
      display: flex;
      align-items: center;
      gap: 10px;
      padding-bottom: 12px;
      border-bottom: 2px solid var(--light-color);
    }

    .form-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 20px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: var(--dark-color);
      font-size: 1rem;
    }

    input, select {
      width: 100%;
      padding: 14px 16px;
      border: 2px solid #e1e5e9;
      border-radius: 8px;
      font-size: 1rem;
      transition: var(--transition);
      background-color: var(--light-color);
      font-family: inherit;
    }

    input:focus, select:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
      background-color: white;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 14px 24px;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      min-width: 120px;
    }

    .btn-primary {
      background: var(--gradient-primary);
      color: white;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(52, 152, 219, 0.3);
    }

    .btn-secondary {
      background: var(--gradient-secondary);
      color: white;
    }

    .btn-secondary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(44, 62, 80, 0.3);
    }

    .btn-outline {
      background: transparent;
      color: var(--primary-color);
      border: 2px solid var(--primary-color);
    }

    .btn-outline:hover {
      background: var(--primary-color);
      color: white;
    }

    .form-actions {
      display: flex;
      gap: 15px;
      margin-top: 25px;
      flex-wrap: wrap;
    }

    .table-container {
      overflow-x: auto;
      border-radius: var(--border-radius);
      box-shadow: var(--box-shadow);
      background: white;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background-color: white;
      min-width: 800px;
    }

    th {
      background: var(--gradient-secondary);
      color: white;
      padding: 16px 12px;
      text-align: right;
      font-weight: 600;
      font-size: 0.95rem;
      white-space: nowrap;
    }

    td {
      padding: 14px 12px;
      border-bottom: 1px solid #e1e5e9;
      font-size: 0.95rem;
      text-align: right;
    }

    tr:hover {
      background-color: rgba(52, 152, 219, 0.05);
    }

    .actions {
      display: flex;
      gap: 8px;
      justify-content: center;
    }

    .actions button {
      background: none;
      border: none;
      cursor: pointer;
      font-size: 1.1rem;
      padding: 6px 8px;
      border-radius: 6px;
      transition: var(--transition);
    }

    .actions button:hover {
      background-color: rgba(0, 0, 0, 0.1);
      transform: scale(1.1);
    }

    .edit-btn {
      color: var(--primary-color);
    }

    .delete-btn {
      color: var(--danger-color);
    }

    .empty-state {
      text-align: center;
      padding: 40px 20px;
      color: #7f8c8d;
    }

    .empty-state i {
      font-size: 3rem;
      margin-bottom: 15px;
      opacity: 0.5;
    }

    .required::after {
      content: " *";
      color: var(--danger-color);
    }

    .section-divider {
      grid-column: 1 / -1;
      height: 1px;
      background: linear-gradient(to right, transparent, #e1e5e9, transparent);
      margin: 10px 0;
    }

    @media (max-width: 768px) {
      body {
        padding: 15px;
      }
      
      .header {
        padding: 20px;
        border-radius: 10px;
      }
      
      .header h2 {
        font-size: 1.8rem;
      }
      
      .card {
        padding: 20px;
      }
      
      .form-actions {
        flex-direction: column;
      }
      
      .btn {
        width: 100%;
      }
      
      th, td {
        padding: 12px 8px;
      }
      
      .connection-status {
        top: 10px;
        left: 10px;
        right: 10px;
        font-size: 12px;
      }
    }

    @media (max-width: 480px) {
      .header {
        border-radius: 8px;
      }
      
      .header h2 {
        font-size: 1.5rem;
      }
      
      .card {
        padding: 15px;
        border-radius: 10px;
      }
      
      input, select {
        padding: 12px 14px;
      }
      
      .btn {
        padding: 12px 20px;
      }
    }

    /* Animations */
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .card, .table-container {
      animation: fadeIn 0.5s ease;
    }

    .salary-badge {
      background: linear-gradient(135deg, #2ecc71, #27ae60);
      color: white;
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 0.85rem;
      font-weight: 600;
    }
  </style>
</head>

<body>
  <div class="container">
    <!-- Ø´Ø±ÙŠØ· Ø­Ø§Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„ -->
    <div class="connection-status">
      <span id="connection-status">
        <i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„...
      </span>
    </div>

    <!-- Ù…Ø¤Ø´Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„ -->
    <div id="loading-spinner" class="loading-spinner">
      <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;">
        <span class="visually-hidden">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</span>
      </div>
    </div>

    <div class="header">
      <h2><i class="fas fa-users"></i> Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</h2>
    </div>

    <div class="main-content">
      <!-- Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¥Ø¶Ø§ÙØ© -->
      <div class="card">
        <h3 class="card-title"><i class="fas fa-user-plus"></i> Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¸Ù Ø¬Ø¯ÙŠØ¯</h3>
        <form id="emp-form">
          <div class="form-grid">
            <div class="form-group">
              <label for="first_name" class="required">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„:</label>
              <input type="text" id="first_name" required placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„" />
            </div>

            <div class="form-group">
              <label for="last_name" class="required">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£Ø®ÙŠØ±:</label>
              <input type="text" id="last_name" required placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£Ø®ÙŠØ±" />
            </div>

            <div class="section-divider"></div>

            <div class="form-group">
              <label for="job_title">Ø§Ù„ÙˆØ¸ÙŠÙØ©:</label>
              <input type="text" id="job_title" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø³Ù…Ù‰ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ" />
            </div>

            <div class="form-group">
              <label for="department_id">Ø§Ù„Ù‚Ø³Ù…:</label>
              <select id="department_id">
                <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø³Ù…</option>
                <option value="1">ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</option>
                <option value="2">Ø§Ù„Ù…Ø§Ù„ÙŠØ©</option>
                <option value="3">Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</option>
                <option value="4">Ø§Ù„ØªØ³ÙˆÙŠÙ‚</option>
                <option value="5">Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©</option>
              </select>
            </div>

            <div class="form-group">
              <label for="salary">Ø§Ù„Ø±Ø§ØªØ¨:</label>
              <input type="number" id="salary" step="0.01" min="0" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ø§ØªØ¨" />
            </div>

            <div class="form-group">
              <label for="hire_date">ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ¹ÙŠÙŠÙ†:</label>
              <input type="date" id="hire_date" />
            </div>
          </div>

          <div class="form-actions">
            <button type="button" id="save-btn" class="btn btn-primary">
              <i class="fas fa-save"></i> Ø­ÙØ¸ Ø§Ù„Ù…ÙˆØ¸Ù
            </button>
            <button type="button" id="clear-btn" class="btn btn-outline">
              <i class="fas fa-broom"></i> Ù…Ø³Ø­ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
            </button>
          </div>
        </form>
      </div>

      <!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† -->
      <div class="card">
        <h3 class="card-title"><i class="fas fa-list"></i> Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</h3>
        <div class="table-container">
          <table id="emp-table">
            <thead>
              <tr>
                <th>#</th>
                <th>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</th>
                <th>Ø§Ù„ÙˆØ¸ÙŠÙØ©</th>
                <th>Ø§Ù„Ù‚Ø³Ù…</th>
                <th>Ø§Ù„Ø±Ø§ØªØ¨</th>
                <th>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ¹ÙŠÙŠÙ†</th>
                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
              </tr>
            </thead>
            <tbody id="emp-table-body">
              <tr>
                <td colspan="7" class="empty-state">
                  <div><i class="fas fa-users"></i></div>
                  <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ù…ÙˆØ¸ÙÙŠÙ†</p>
                  <small>Ù‚Ù… Ø¨Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¸Ù Ø¬Ø¯ÙŠØ¯ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù†Ù…ÙˆØ°Ø¬</small>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <script>
    // EmployeeApp - Ù…Ø¹ Ø¯Ø¹Ù… Supabase
    class EmployeeApp {
      constructor() {
        // ØªÙƒÙˆÙŠÙ† Supabase
        this.SUPABASE_URL = 'https://rvjacvrrpguehbapvewe.supabase.co';
        this.SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ2amFjdnJycGd1ZWhiYXB2ZXdlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMwMjUxNTksImV4cCI6MjA3ODYwMTE1OX0.wSavKzxKOF7-56G-pzDMtbXNrCNAbGs0wvadw-cilBg';
        this.supabase = null;
        this.isOnline = false;
        this.currentEditId = null; // Ù„ØªØªØ¨Ø¹ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
        
        this.init();
      }

      async init() {
        this.dom = this._initDOM();
        this._bindEvents();
        const connected = await this.initSupabase();
        
        if (connected) {
          await this.loadEmployees();
        } else {
          this.showError('ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª.');
        }
      }

      _initDOM() {
        return {
          form: document.getElementById("emp-form"),
          firstName: document.getElementById("first_name"),
          lastName: document.getElementById("last_name"),
          jobTitle: document.getElementById("job_title"),
          department: document.getElementById("department_id"),
          salary: document.getElementById("salary"),
          hireDate: document.getElementById("hire_date"),
          saveBtn: document.getElementById("save-btn"),
          clearBtn: document.getElementById("clear-btn"),
          tableBody: document.querySelector("#emp-table-body"),
          connectionStatus: document.getElementById("connection-status"),
          loadingSpinner: document.getElementById("loading-spinner")
        };
      }

      _bindEvents() {
        // Ø¥Ø²Ø§Ù„Ø© event listener Ù…Ù† Ø§Ù„ÙÙˆØ±Ù… ÙˆØ¥Ø¶Ø§ÙØªÙ‡ Ù„Ù„Ø²Ø± Ù…Ø¨Ø§Ø´Ø±Ø©
        this.dom.saveBtn.addEventListener("click", () => this.saveEmployee());
        this.dom.clearBtn.addEventListener("click", () => this.clearForm());
        
        // ØªØ¹Ø¨Ø¦Ø© Ù‚Ø³Ù… Ø§Ù„ØªÙˆØ§Ø±ÙŠØ® Ø¨Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
        this.dom.hireDate.valueAsDate = new Date();
      }

      async initSupabase() {
        try {
          this.showLoading(true);
          this.updateConnectionStatus('warning', '<i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„...');
          
          console.log('ğŸ”„ Ø¬Ø§Ø±ÙŠ ØªÙ‡ÙŠØ¦Ø© Supabase...');
          this.supabase = supabase.createClient(this.SUPABASE_URL, this.SUPABASE_KEY);
          
          // Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„Ø¨Ø³ÙŠØ·
          const { data, error } = await this.supabase.auth.getSession();
          
          if (error) {
            console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©:', error);
            throw error;
          }

          // Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ø¯ÙˆÙ„ employees
          const { data: empData, error: empError } = await this.supabase
            .from('employees')
            .select('count')
            .limit(1)
            .single();

          if (empError && empError.code !== 'PGRST116') {
            console.warn('âš ï¸ ØªØ­Ø°ÙŠØ± ÙÙŠ Ø¬Ø¯ÙˆÙ„ employees:', empError);
          }

          this.isOnline = true;
          this.updateConnectionStatus('success', '<i class="fas fa-cloud-check"></i> Ù…ØªØµÙ„ Ø¨Ø§Ù„Ø³Ø­Ø§Ø¨Ø©');
          console.log('âœ… Supabase Ù…ØªØµÙ„ Ø¨Ù†Ø¬Ø§Ø­');
          return true;
          
        } catch (error) {
          console.error('âŒ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ Supabase:', error);
          this.isOnline = false;
          this.updateConnectionStatus('danger', '<i class="fas fa-cloud-slash"></i> ØºÙŠØ± Ù…ØªØµÙ„');
          
          // Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø·Ø£ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
          let errorMessage = 'ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª';
          if (error.message) {
            errorMessage += `: ${error.message}`;
          }
          this.showError(errorMessage);
          return false;
        } finally {
          this.showLoading(false);
        }
      }

      // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„
      updateConnectionStatus(type, message) {
        if (!this.dom.connectionStatus) return;
        
        this.dom.connectionStatus.innerHTML = message;
        this.dom.connectionStatus.style.borderLeftColor = 
          type === 'success' ? '#28a745' : 
          type === 'danger' ? '#dc3545' : '#ffc107';
      }

      // Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ù…Ø¤Ø´Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„
      showLoading(show) {
        if (this.dom.loadingSpinner) {
          this.dom.loadingSpinner.style.display = show ? 'block' : 'none';
        }
      }

      async loadEmployees() {
        try {
          this.showLoading(true);
          console.log('ğŸ”„ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†...');
          
          if (!this.supabase) {
            throw new Error('Supabase ØºÙŠØ± Ù…Ù‡ÙŠØ¦');
          }

          const { data, error } = await this.supabase
            .from('employees')
            .select('*')
            .order('emp_id');

          if (error) {
            console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†:', error);
            
            // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¬Ø¯ÙˆÙ„ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ØŒ Ù†Ø¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©
            if (error.code === '42P01') {
              console.log('âš ï¸ Ø¬Ø¯ÙˆÙ„ employees ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ØŒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©');
              this.loadSampleEmployees();
              return;
            }
            throw error;
          }

          console.log('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†:', data);
          this.renderEmployees(data || []);
              
        } catch (error) {
          console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†:', error);
          this.loadSampleEmployees();
        } finally {
          this.showLoading(false);
        }
      }

      // ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ù„Ù„Ù…ÙˆØ¸ÙÙŠÙ†
      loadSampleEmployees() {
        const sampleEmployees = [
          {
            emp_id: 1,
            first_name: 'Ø£Ø­Ù…Ø¯',
            last_name: 'Ù…Ø­Ù…Ø¯',
            job_title: 'Ù…Ø·ÙˆØ± ÙˆÙŠØ¨',
            department_id: 1,
            salary: 8500,
            hire_date: '2023-01-15'
          },
          {
            emp_id: 2,
            first_name: 'ÙØ§Ø·Ù…Ø©',
            last_name: 'Ø¹Ù„ÙŠ',
            job_title: 'Ù…Ø­Ø§Ø³Ø¨',
            department_id: 2,
            salary: 7200,
            hire_date: '2022-08-22'
          },
          {
            emp_id: 3,
            first_name: 'ÙŠÙˆØ³Ù',
            last_name: 'Ø®Ø§Ù„Ø¯',
            job_title: 'Ù…Ø¯ÙŠØ± Ù…Ø¨ÙŠØ¹Ø§Øª',
            department_id: 3,
            salary: 10500,
            hire_date: '2021-05-10'
          }
        ];
        
        this.renderEmployees(sampleEmployees);
        this.showInfo('ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ù„Ù„Ù…ÙˆØ¸ÙÙŠÙ†');
      }

      renderEmployees(employees) {
        if (!employees || employees.length === 0) {
          this.dom.tableBody.innerHTML = `
            <tr>
              <td colspan="7" class="empty-state">
                <div><i class="fas fa-users"></i></div>
                <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ù…ÙˆØ¸ÙÙŠÙ†</p>
                <small>Ù‚Ù… Ø¨Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¸Ù Ø¬Ø¯ÙŠØ¯ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù†Ù…ÙˆØ°Ø¬</small>
              </td>
            </tr>
          `;
          return;
        }

        this.dom.tableBody.innerHTML = employees.map(emp => {
          const departmentNames = {
            1: 'ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª',
            2: 'Ø§Ù„Ù…Ø§Ù„ÙŠØ©',
            3: 'Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª',
            4: 'Ø§Ù„ØªØ³ÙˆÙŠÙ‚',
            5: 'Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©'
          };

          const departmentName = departmentNames[emp.department_id] || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
          const formattedSalary = emp.salary ? `<span class="salary-badge">${emp.salary.toLocaleString()} Ø±.Ø³</span>` : '-';
          const hireDate = emp.hire_date ? new Date(emp.hire_date).toLocaleDateString('ar-SA') : '-';

          return `
            <tr>
              <td>${emp.emp_id}</td>
              <td>${emp.first_name} ${emp.last_name}</td>
              <td>${emp.job_title || '-'}</td>
              <td>${departmentName}</td>
              <td>${formattedSalary}</td>
              <td>${hireDate}</td>
              <td class="actions">
                <button class="edit-btn" onclick="app.editEmployee(${emp.emp_id})">
                  <i class="fas fa-edit"></i>
                </button>
                <button class="delete-btn" onclick="app.deleteEmployee(${emp.emp_id})">
                  <i class="fas fa-trash"></i>
                </button>
              </td>
            </tr>
          `;
        }).join("");
      }

      async saveEmployee() {
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        if (!this.dom.firstName.value.trim() || !this.dom.lastName.value.trim()) {
          this.showError('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„ ÙˆØ§Ù„Ø§Ø³Ù… Ø§Ù„Ø£Ø®ÙŠØ±');
          return;
        }

        const empData = {
          first_name: this.dom.firstName.value.trim(),
          last_name: this.dom.lastName.value.trim(),
          job_title: this.dom.jobTitle.value.trim(),
          department_id: this.dom.department.value || null,
          salary: this.dom.salary.value ? parseFloat(this.dom.salary.value) : null,
          hire_date: this.dom.hireDate.value
        };

        try {
          this.showLoading(true);
          
          if (!this.supabase || !this.isOnline) {
            this.showInfo('âš ï¸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø­ÙØ¸ - ØºÙŠØ± Ù…ØªØµÙ„ Ø¨Ø§Ù„Ø³Ø­Ø§Ø¨Ø©');
            return;
          }

          let result;
          if (this.currentEditId) {
            // Ø­Ø§Ù„Ø© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
            result = await this.supabase
              .from('employees')
              .update(empData)
              .eq('emp_id', this.currentEditId);
          } else {
            // Ø­Ø§Ù„Ø© Ø§Ù„Ø¥Ø¶Ø§ÙØ©
            result = await this.supabase
              .from('employees')
              .insert([empData])
              .select();
          }

          if (result.error) {
            throw result.error;
          }

          const message = this.currentEditId ? 'âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ÙˆØ¸Ù Ø¨Ù†Ø¬Ø§Ø­' : 'âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…ÙˆØ¸Ù Ø¨Ù†Ø¬Ø§Ø­';
          this.showSuccess(message);
          this.clearForm();
          await this.loadEmployees();
              
        } catch (error) {
          console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ù…ÙˆØ¸Ù:', error);
          this.showError('ÙØ´Ù„ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ' + error.message);
        } finally {
          this.showLoading(false);
        }
      }

      async deleteEmployee(id) {
        if (!confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆØ¸ÙØŸ")) return;

        try {
          this.showLoading(true);
          
          if (!this.supabase || !this.isOnline) {
            this.showInfo('âš ï¸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø­Ø°Ù - ØºÙŠØ± Ù…ØªØµÙ„ Ø¨Ø§Ù„Ø³Ø­Ø§Ø¨Ø©');
            return;
          }

          const { error } = await this.supabase
            .from('employees')
            .delete()
            .eq('emp_id', id);

          if (error) {
            throw error;
          }

          this.showSuccess('âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…ÙˆØ¸Ù Ø¨Ù†Ø¬Ø§Ø­');
          await this.loadEmployees();
              
        } catch (error) {
          console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…ÙˆØ¸Ù:', error);
          this.showError('ÙØ´Ù„ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ' + error.message);
        } finally {
          this.showLoading(false);
        }
      }

      async editEmployee(id) {
        try {
          this.showLoading(true);
          
          if (!this.supabase || !this.isOnline) {
            this.showInfo('âš ï¸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ - ØºÙŠØ± Ù…ØªØµÙ„ Ø¨Ø§Ù„Ø³Ø­Ø§Ø¨Ø©');
            return;
          }

          const { data, error } = await this.supabase
            .from('employees')
            .select('*')
            .eq('emp_id', id)
            .single();

          if (error) {
            throw error;
          }

          // ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
          this.dom.firstName.value = data.first_name;
          this.dom.lastName.value = data.last_name;
          this.dom.jobTitle.value = data.job_title || '';
          this.dom.department.value = data.department_id || '';
          this.dom.salary.value = data.salary || '';
          this.dom.hireDate.value = data.hire_date || '';

          // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø²Ø± Ù„Ù„Ù†Ù…Ø· Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ÙŠ
          this.currentEditId = id;
          this.dom.saveBtn.innerHTML = '<i class="fas fa-edit"></i> ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ÙˆØ¸Ù';
          this.dom.saveBtn.classList.remove('btn-primary');
          this.dom.saveBtn.classList.add('btn-secondary');
          
          this.showInfo('ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù');
              
        } catch (error) {
          console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù:', error);
          this.showError('ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù Ù„Ù„ØªØ¹Ø¯ÙŠÙ„');
        } finally {
          this.showLoading(false);
        }
      }

      clearForm() {
        this.dom.form.reset();
        this.dom.hireDate.valueAsDate = new Date();
        
        // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø²Ø± Ù„Ø­Ø§Ù„ØªÙ‡ Ø§Ù„Ø£ØµÙ„ÙŠØ©
        this.currentEditId = null;
        this.dom.saveBtn.innerHTML = '<i class="fas fa-save"></i> Ø­ÙØ¸ Ø§Ù„Ù…ÙˆØ¸Ù';
        this.dom.saveBtn.classList.remove('btn-secondary');
        this.dom.saveBtn.classList.add('btn-primary');
      }

      // Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„Ø±Ø³Ø§Ø¦Ù„
      showError(message) {
        alert(`âŒ ${message}`);
      }

      showSuccess(message) {
        alert(`âœ… ${message}`);
      }

      showInfo(message) {
        alert(`â„¹ï¸ ${message}`);
      }
    }

    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
    const app = new EmployeeApp();
  </script>
</body>
</html>